FROM gradle:jdk8-alpine

ARG APP_NAME_ARG
ARG BUILD_PATH_ARG
ARG WAR_NAME_ARG
ARG DB_NAME_ARG
ARG DB_USERNAME_ARG
ARG DB_PASSWORD_ARG
ARG DB_PORT_ARG
ARG DB_DOMAIN_ARG
ARG TEMP_FOLDER_ARG

ENV APP_NAME ${APP_NAME_ARG}
ENV BUILD_PATH ${BUILD_PATH_ARG}
ENV WAR_NAME ${WAR_NAME_ARG}
ENV DB_NAME ${DB_NAME_ARG}
ENV DB_USERNAME ${DB_USERNAME_ARG}
ENV DB_PASSWORD ${DB_PASSWORD_ARG}
ENV DB_PORT ${DB_PORT_ARG}
ENV DB_DOMAIN ${DB_DOMAIN_ARG}
ENV TEMP_FOLDER ${TEMP_FOLDER_ARG}

WORKDIR /var/app
ADD ./whoami /var/app/whoami

USER root
RUN chown -R gradle:gradle /var/app
COPY ./docker/run.sh run.sh
RUN chmod +x run.sh
USER gradle

#For debug.

CMD ["/bin/sh", "run.sh"]